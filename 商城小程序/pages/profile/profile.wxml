<!--pages/profile/profile.wxml-->
<view class="profile-container">
  <!-- 会员信息区域 -->
  <view class="member-section">
    <view class="member-header">
      <view class="member-info-row">
        <view class="member-code">
          <text class="code-text">会员码</text>
          <text class="level-text">LV 2</text>
        </view>
        <view class="user-greeting" bindtap="onUserGreetingTap">
          <text class="greeting-text">hi，{{userDisplayName}}</text>
        </view>
      </view>
      <view class="member-title">
        <text class="title-text">资深养鸭人</text>
      </view>
      <view class="progress-section">
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{progressPercent}}%"></view>
        </view>
        <text class="progress-text">{{progressText}}</text>
      </view>
    </view>
    <view class="member-avatar">
      <image-placeholder type="avatar" custom-class="duck-image" src="{{duckImage}}" mode="aspectFit"></image-placeholder>
      <view class="expert-badge">
        <text class="badge-text">EXPERT</text>
      </view>
    </view>
  </view>

  <!-- 权益卡片 -->
  <benefit-card 
    member-level="{{memberInfo.level}}"
    member-level-name="{{memberInfo.levelName}}"
    benefits-count="{{benefitsInfo.count}}"
    benefits-list="{{benefitsInfo.items}}"
    bind:benefittap="onBenefitTap"
    bind:viewall="onViewAllBenefits">
  </benefit-card>

  <!-- 我的资产 -->
  <view class="assets-section">
    <text class="section-title">我的资产</text>
    <view class="assets-grid">
      <view class="asset-item" bindtap="onCouponTap">
        <text class="asset-value">{{userInfo.coupons || 0}}</text>
        <text class="asset-label">优惠券</text>
        <view class="asset-icon">🎫</view>
      </view>
      <view class="asset-item">
        <text class="asset-value">{{userInfo.balance || 0}}</text>
        <text class="asset-label">余额</text>
        <view class="asset-icon">💴</view>
      </view>
      <view class="asset-item">
        <text class="asset-value">{{userInfo.points || 59.9}}</text>
        <text class="asset-label">积分</text>
        <view class="asset-icon">🪙</view>
    </view>
    </view>
  </view>

  <!-- 我的功能 -->
  <view class="function-section">
    <text class="section-title">我的功能</text>
    
    <view class="function-grid">
      <block wx:for="{{functionMenus}}" wx:key="index" wx:for-index="rowIndex">
        <view class="function-row">
          <block wx:for="{{item}}" wx:key="path" wx:for-item="menu">
            <view class="function-item" bindtap="onMenuTap" data-path="{{menu.path}}">
              <image-placeholder type="default" custom-class="function-icon" src="{{menu.icon}}" mode="aspectFit"></image-placeholder>
              <text class="function-name">{{menu.name}}</text>
            </view>
          </block>
        </view>
      </block>
    </view>
    
    <!-- 调试功能按钮 -->
    <view class="debug-section">
      <button class="debug-btn" bindtap="goToDebug">
        🐛 调试工具
      </button>
    </view>
  </view>

  <!-- 心意礼卡 -->
  <view class="gift-section">
    <view class="gift-header">
      <text class="section-title">心意礼卡</text>
      <view class="view-all" bindtap="onViewAllGifts">
        <text class="view-all-text">查看 全部</text>
        <text class="arrow">»</text>
      </view>
    </view>
    
    <view class="gift-cards">
      <block wx:for="{{giftCards}}" wx:key="id">
        <view class="gift-card" bindtap="onGiftCardTap" data-id="{{item.id}}">
          <image-placeholder type="product" custom-class="gift-image" src="{{item.image}}" mode="aspectFill"></image-placeholder>
          <view class="gift-overlay">
            <view class="gift-price">
              <text class="price-symbol">￥</text>
              <text class="price-value">{{item.price}}</text>
            </view>
            <text class="gift-title">{{item.title}}</text>
            <text class="gift-brand">{{item.brand}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>
</view>