<!-- æ‰‹æœºå·è·å–åŠŸèƒ½æ¼”ç¤ºé¡µé¢ -->
<view class="container">
  <view class="header">
    <text class="title">æ‰‹æœºå·è·å–åŠŸèƒ½æ¼”ç¤º</text>
    <text class="subtitle">æµ‹è¯•å¾®ä¿¡å°ç¨‹åºæ‰‹æœºå·å¿«é€ŸéªŒè¯ç»„ä»¶</text>
  </view>

  <!-- å½“å‰çŠ¶æ€ -->
  <view class="status-section">
    <view class="status-card">
      <view class="status-header">
        <text class="status-title">å½“å‰çŠ¶æ€</text>
        <text class="status-badge {{phoneStatus === 'å·²è·å–' ? 'success' : 'pending'}}">{{phoneStatus}}</text>
      </view>
      
      <view class="phone-display" wx:if="{{userPhone}}">
        <text class="phone-label">æ‰‹æœºå·ï¼š</text>
        <text class="phone-number">{{maskedPhone}}</text>
        <view class="phone-actions">
          <button class="action-btn" bindtap="showFullPhone">æŸ¥çœ‹å®Œæ•´</button>
          <button class="action-btn" bindtap="copyPhone">å¤åˆ¶</button>
          <button class="action-btn danger" bindtap="clearPhone">æ¸…é™¤</button>
        </view>
      </view>
      
      <view class="no-phone" wx:else>
        <text class="no-phone-text">æš‚æ— æ‰‹æœºå·ä¿¡æ¯</text>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <button class="primary-btn" bindtap="showPhonePopup">
      <text class="btn-icon">ğŸ“±</text>
      <text class="btn-text">è·å–æ‰‹æœºå·</text>
    </button>
    
    <button class="secondary-btn" bindtap="testCloudFunction">
      <text class="btn-icon">ğŸ”§</text>
      <text class="btn-text">æµ‹è¯•äº‘å‡½æ•°</text>
    </button>
  </view>

  <!-- è°ƒè¯•ä¿¡æ¯ -->
  <view class="debug-section" wx:if="{{debugInfo.length > 0}}">
    <view class="debug-header">
      <text class="debug-title">è°ƒè¯•ä¿¡æ¯</text>
      <text class="debug-count">({{debugInfo.length}})</text>
      <view class="debug-actions">
        <button class="debug-btn" bindtap="clearDebugInfo">æ¸…é™¤</button>
        <button class="debug-btn" bindtap="copyDebugInfo">å¤åˆ¶</button>
      </view>
    </view>
    
    <view class="debug-list">
      <view class="debug-item" wx:for="{{debugInfo}}" wx:key="*this">
        <text class="debug-text">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- å†å²è®°å½• -->
  <view class="history-section" wx:if="{{phoneHistory.length > 0}}">
    <view class="history-header">
      <text class="history-title">æ“ä½œå†å²</text>
      <text class="history-count">({{phoneHistory.length}})</text>
    </view>
    
    <view class="history-list">
      <view class="history-item" wx:for="{{phoneHistory}}" wx:key="timestamp">
        <view class="history-time">{{item.timestamp}}</view>
        <view class="history-status">
          <text class="status-text {{item.status}}">
            {{item.status === 'success' ? 'æˆåŠŸ' : 
              item.status === 'error' ? 'å¤±è´¥' : 
              item.status === 'rejected' ? 'æ‹’ç»' : 
              item.status === 'quota_exceeded' ? 'é¢åº¦ä¸è¶³' : 
              item.status === 'use_other' ? 'ä½¿ç”¨å…¶ä»–' : 'æœªçŸ¥'}}
          </text>
        </view>
        <view class="history-detail" wx:if="{{item.phoneNumber}}">
          <text class="detail-label">æ‰‹æœºå·ï¼š</text>
          <text class="detail-value">{{item.phoneNumber}}</text>
        </view>
        <view class="history-detail" wx:if="{{item.error}}">
          <text class="detail-label">é”™è¯¯ï¼š</text>
          <text class="detail-value error">{{item.error}}</text>
        </view>
        <view class="history-detail" wx:if="{{item.errno}}">
          <text class="detail-label">é”™è¯¯ç ï¼š</text>
          <text class="detail-value error">{{item.errno}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½è¯´æ˜ -->
  <view class="info-section">
    <view class="info-card">
      <text class="info-title">åŠŸèƒ½è¯´æ˜</text>
      <view class="info-content">
        <text class="info-item">â€¢ ä½¿ç”¨å¾®ä¿¡å®˜æ–¹æ‰‹æœºå·å¿«é€ŸéªŒè¯ç»„ä»¶</text>
        <text class="info-item">â€¢ æ”¯æŒäº‘å‡½æ•°è§£å¯†æ‰‹æœºå·æ•°æ®</text>
        <text class="info-item">â€¢ å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º</text>
        <text class="info-item">â€¢ æ‰‹æœºå·æ©ç æ˜¾ç¤ºä¿æŠ¤éšç§</text>
        <text class="info-item">â€¢ æ“ä½œå†å²è®°å½•å’ŒçŠ¶æ€è·Ÿè¸ª</text>
        <text class="info-item">â€¢ å®æ—¶è°ƒè¯•ä¿¡æ¯æ˜¾ç¤º</text>
      </view>
    </view>
  </view>

  <!-- ç™»å½•å¼¹çª—ç»„ä»¶ -->
  <login-popup-system
    show-phone-popup="{{showPhonePopup}}"
    bind:phoneNumberSuccess="onPhoneNumberSuccess"
    bind:phoneNumberError="onPhoneNumberError"
    bind:phoneNumberReject="onPhoneNumberReject"
    bind:phoneNumberQuotaExceeded="onPhoneNumberQuotaExceeded"
    bind:useOtherPhone="onUseOtherPhone"
  />
</view> 