# 客户信息自动填充修复说明

## 问题描述

选择客户后，客户姓名、联系电话和收货地址没有自动填充到订单表单中。

## 问题原因

在 `selectCustomer` 函数中，客户信息的填充逻辑使用了 `||` 操作符，这会导致如果客户信息为空，就会保持之前的值，而不是清空字段。

**原始代码（有问题）：**
```javascript
setOrderForm(prev => ({
  ...prev,
  customerId: c._id,
  customerName: c.name || prev.customerName,  // 如果c.name为空，保持之前的值
  customerPhone: c.phone || prev.customerPhone,  // 如果c.phone为空，保持之前的值
  customerAddress: fullAddress || prev.customerAddress,  // 如果地址为空，保持之前的值
  // 重置预存状态
  usePrepaid: false,
  prepaidAmount: 0,
  prepaidProducts: [],
  prepaidType: 'amount'
}));
```

## 修复方案

将 `|| prev.xxx` 改为 `|| ""`，确保如果客户信息为空，字段会被清空而不是保持之前的值。

**修复后的代码：**
```javascript
setOrderForm(prev => ({
  ...prev,
  customerId: c._id,
  customerName: c.name || "",  // 如果c.name为空，设置为空字符串
  customerPhone: c.phone || "",  // 如果c.phone为空，设置为空字符串
  customerAddress: fullAddress || "",  // 如果地址为空，设置为空字符串
  // 重置预存状态
  usePrepaid: false,
  prepaidAmount: 0,
  prepaidProducts: [],
  prepaidType: 'amount'
}));
```

## 修复效果

### ✅ 修复前的问题
- 选择客户后，如果客户信息为空，字段会保持之前的值
- 用户无法看到客户信息是否真的为空
- 可能导致表单数据不准确

### ✅ 修复后的效果
- 选择客户后，客户信息会正确填充到表单中
- 如果客户信息为空，字段会被清空，显示为空
- 用户可以清楚地看到客户信息的实际状态
- 表单数据更加准确和可靠

## 测试场景

### 1. 客户信息完整的情况
1. 选择一个有完整信息的客户（姓名、电话、地址都有）
2. 验证表单字段是否正确填充

### 2. 客户信息不完整的情况
1. 选择一个信息不完整的客户（某些字段为空）
2. 验证空字段是否显示为空，而不是保持之前的值

### 3. 切换客户的情况
1. 先选择一个客户
2. 再选择另一个客户
3. 验证表单字段是否正确更新为新客户的信息

## 技术细节

### 修改的文件
- `src/pages/ShopOrderPage.jsx` 第191-193行

### 修改内容
```diff
- customerName: c.name || prev.customerName,
+ customerName: c.name || "",
- customerPhone: c.phone || prev.customerPhone,
+ customerPhone: c.phone || "",
- customerAddress: fullAddress || prev.customerAddress,
+ customerAddress: fullAddress || "",
```

### 影响范围
- 只影响客户选择功能
- 不影响其他功能
- 向后兼容，不会破坏现有功能

## 总结

通过这个简单的修复，客户信息自动填充功能现在能够正确工作：

1. **准确填充**：客户信息会正确填充到表单中
2. **清空空值**：空字段会被清空，而不是保持之前的值
3. **用户体验**：用户可以清楚地看到客户信息的实际状态
4. **数据准确性**：表单数据更加准确和可靠

这个修复确保了客户选择功能的正确性和用户体验的流畅性。
