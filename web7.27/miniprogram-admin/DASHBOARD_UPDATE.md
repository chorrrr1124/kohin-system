# 仪表盘数据更新说明

## 修改内容

### 1. 移除硬编码数据
- 删除了 `DashboardPage.jsx` 中的模拟数据
- 所有统计数据现在从真实的数据库获取

### 2. 新增API服务
- 创建了 `src/api/dashboardApi.js` 文件
- 包含以下API函数：
  - `getDashboardStats()` - 获取仪表盘统计数据
  - `getRecentOrders()` - 获取最近订单
  - `getLowStockProducts()` - 获取库存预警商品
  - `getCustomerStats()` - 获取客户统计数据

### 3. 数据来源
所有数据现在从CloudBase数据库的以下集合获取：
- `customers` - 客户数据
- `orders` - 订单数据  
- `prepaid_records` - 预存记录
- `products` - 商品数据

### 4. 错误处理
- 添加了完善的错误处理机制
- API调用失败时不会阻塞界面显示
- 失败时显示空数据而不是崩溃

### 5. 性能优化
- 使用 `Promise.all()` 并行获取数据
- 减少数据库查询次数
- 提高页面加载速度

## 数据统计说明

### 统计指标
- **总客户数**: 从 `customers` 集合统计
- **今日订单**: 今日创建的订单数量
- **今日收入**: 今日已完成订单的总金额
- **库存预警**: 库存低于最低库存的商品数量

### 最近订单
- 显示最新的5个订单
- 包含客户名称、金额、状态、创建时间

### 库存预警
- 显示库存不足的商品
- 包含商品名称、当前库存、最低库存

## 注意事项

1. 确保CloudBase环境配置正确
2. 确保数据库集合存在且有数据
3. 确保用户有相应的数据库访问权限
4. 如果API调用失败，界面会显示空数据而不是错误

## 备份文件
- 原始文件已备份为 `DashboardPage.jsx.backup`
- 如需回滚，可使用备份文件
