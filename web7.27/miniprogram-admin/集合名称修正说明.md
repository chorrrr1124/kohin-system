# 集合名称修正说明

## 🎯 修正概述

根据用户反馈，web端仓库库存管理数据应该使用 `products` 集合，而不是 `shopProducts` 集合。本次修改将所有相关代码中的集合名称进行了统一修正。

## 🔄 具体修改内容

### 1. 前端页面文件修正

#### `src/pages/InventoryManagePage.jsx` - 库存管理页面
**修改内容：**
- 将 `db.collection('shopProducts')` 改为 `db.collection('products')`
- 涉及的操作：查询、新增、更新、删除、状态切换

**修改位置：**
- 第66行：加载库存数据查询
- 第190行：更新产品信息
- 第194行：新增产品
- 第230行：删除产品
- 第243行：切换产品状态

#### `src/pages/DashboardPage.jsx` - 仪表板页面
**修改内容：**
- 将 `db.collection('shopProducts')` 改为 `db.collection('products')`
- 涉及的操作：产品统计、低库存查询

**修改位置：**
- 第109-110行：产品统计查询

#### `src/pages/ShopPage.jsx` - 商城管理页面
**修改内容：**
- 将 `db.collection('shopProducts')` 改为 `db.collection('products')`
- 涉及的操作：查询、新增、更新、删除、批量操作、分类获取

**修改位置：**
- 第72行：低库存预警查询
- 第117行：删除商品
- 第123行：更新商品状态
- 第188行：更新商品信息
- 第218行：导出商品数据
- 第267行：获取商品分类
- 第294行：构建查询条件
- 第398行：新增商品
- 第461行：更新商品
- 第506行：切换商品状态
- 第530行：删除商品
- 第552行：删除商品（批量操作）
- 第558行：更新商品状态（批量操作）

### 2. 云函数文件修正

#### `cloudfunctions/initInventory/index.js` - 库存初始化云函数
**修改内容：**
- 将 `db.createCollection('shopProducts')` 改为 `db.createCollection('products')`
- 将 `db.collection('shopProducts')` 改为 `db.collection('products')`

**修改位置：**
- 第13行：创建集合
- 第16行：获取集合引用

#### `cloudfunctions/initDatabase/index.js` - 数据库初始化云函数
**修改内容：**
- 将 `db.createCollection('shopProducts')` 改为 `db.createCollection('products')`

**修改位置：**
- 第113行：创建商城产品集合

## 🎯 修正原因

1. **数据一致性**：web端应该与小程序端使用相同的集合名称
2. **命名规范**：`products` 比 `shopProducts` 更简洁明了
3. **避免混淆**：防止在开发过程中使用错误的集合名称

## 🔍 影响范围

### 直接影响
- 库存管理页面的所有数据库操作
- 商城管理页面的所有数据库操作
- 仪表板页面的产品统计功能
- 数据库初始化流程

### 间接影响
- 需要确保数据库中已存在 `products` 集合
- 如果之前使用的是 `shopProducts` 集合，需要迁移数据

## ⚠️ 注意事项

1. **数据迁移**：如果数据库中已有 `shopProducts` 集合的数据，需要手动迁移到 `products` 集合
2. **权限设置**：确保 `products` 集合的数据库权限配置正确
3. **测试验证**：修改后需要全面测试所有相关功能

## 🚀 部署建议

1. **备份数据**：部署前备份现有数据
2. **数据迁移**：将 `shopProducts` 集合数据迁移到 `products` 集合
3. **功能测试**：部署后测试所有相关功能
4. **清理旧集合**：确认功能正常后，可以删除 `shopProducts` 集合

## 📋 测试清单

- [ ] 库存管理页面的增删改查功能
- [ ] 商城管理页面的商品操作功能
- [ ] 仪表板页面的产品统计功能
- [ ] 数据库初始化功能
- [ ] 数据导入导出功能

---

**修改完成时间：** 2024年12月
**修改人员：** AI Assistant
**版本：** v1.0.0
**修改类型：** 集合名称统一修正 