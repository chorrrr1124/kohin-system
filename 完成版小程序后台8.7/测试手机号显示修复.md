# å°ç¨‹åºç«¯æ‰‹æœºå·æ˜¾ç¤ºä¿®å¤

## ğŸ› é—®é¢˜æè¿°
åœ¨å°ç¨‹åºç«¯é¢„å­˜è®°å½•æ—¶ï¼Œå¦‚æœå®¢æˆ·çš„è”ç³»äººä¿¡æ¯ä¸å®Œæ•´ï¼Œä¼šå¯¼è‡´æ‰‹æœºå·ç ä¸èƒ½æ­£ç¡®æ˜¾ç¤ºã€‚

## ğŸ”§ ä¿®å¤å†…å®¹

### 1. ä¿®å¤å®¢æˆ·é€‰æ‹©é€»è¾‘ (addRecord.js)

**ä¿®å¤å‰ï¼š**
```javascript
// ç›´æ¥è®¿é—®ï¼Œå¯èƒ½æŠ¥é”™
'record.customerPhone': customer.contacts[0].phone,
```

**ä¿®å¤åï¼š**
```javascript
// å®‰å…¨è·å–å®¢æˆ·ç”µè¯å·ç 
let customerPhone = '';
if (customer.phone) {
  // ä¼˜å…ˆä½¿ç”¨å®¢æˆ·ä¸»è¦ç”µè¯
  customerPhone = customer.phone;
} else if (customer.contacts && customer.contacts.length > 0 && customer.contacts[0].phone) {
  // å…¶æ¬¡ä½¿ç”¨ç¬¬ä¸€ä¸ªè”ç³»äººç”µè¯
  customerPhone = customer.contacts[0].phone;
}
```

### 2. ä¿®å¤å®¢æˆ·åˆ—è¡¨æ˜¾ç¤º (addRecord.wxml)

**ä¿®å¤å‰ï¼š**
```xml
<view class="customer-phone">{{item.contacts[0].phone}}</view>
```

**ä¿®å¤åï¼š**
```xml
<view class="customer-phone">{{item.phone || (item.contacts && item.contacts[0] && item.contacts[0].phone) || 'æœªè®¾ç½®ç”µè¯'}}</view>
```

### 3. ä¿®å¤æœç´¢åŠŸèƒ½

**ä¿®å¤å‰ï¼š**
```javascript
// åªæœç´¢contactsæ•°ç»„ï¼Œä¸å®‰å…¨
for (let contact of customer.contacts) {
  if (contact.phone.includes(searchKey)) {
    return true;
  }
}
```

**ä¿®å¤åï¼š**
```javascript
// æœç´¢å®¢æˆ·ä¸»è¦ç”µè¯
if (customer.phone && customer.phone.includes(searchKey)) {
  return true;
}
// å®‰å…¨æœç´¢è”ç³»äººç”µè¯
if (customer.contacts && customer.contacts.length > 0) {
  for (let contact of customer.contacts) {
    if (contact.phone && contact.phone.includes(searchKey)) {
      return true;
    }
  }
}
```

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### æµ‹è¯•ç”¨ä¾‹1ï¼šå®Œæ•´å®¢æˆ·æ•°æ®
```javascript
// æœ‰ä¸»è¦ç”µè¯ + è”ç³»äººä¿¡æ¯
customer = {
  _id: "test1",
  name: "å¼ ä¸‰",
  phone: "13888888888",
  contacts: [
    { name: "å¼ ä¸‰", phone: "13888888888" }
  ]
}
// é¢„æœŸç»“æœï¼šæ˜¾ç¤º 13888888888
```

### æµ‹è¯•ç”¨ä¾‹2ï¼šåªæœ‰è”ç³»äººç”µè¯
```javascript
// æ²¡æœ‰ä¸»è¦ç”µè¯ï¼Œåªæœ‰è”ç³»äººä¿¡æ¯
customer = {
  _id: "test2", 
  name: "æå››",
  contacts: [
    { name: "æå››", phone: "13999999999" }
  ]
}
// é¢„æœŸç»“æœï¼šæ˜¾ç¤º 13999999999
```

### æµ‹è¯•ç”¨ä¾‹3ï¼šç©ºè”ç³»äººä¿¡æ¯
```javascript
// æ²¡æœ‰ç”µè¯ä¿¡æ¯
customer = {
  _id: "test3",
  name: "ç‹äº”",
  contacts: []
}
// é¢„æœŸç»“æœï¼šæ˜¾ç¤º "æœªè®¾ç½®ç”µè¯"
```

### æµ‹è¯•ç”¨ä¾‹4ï¼šä¸å®Œæ•´è”ç³»äººä¿¡æ¯
```javascript
// è”ç³»äººå­˜åœ¨ä½†æ²¡æœ‰ç”µè¯
customer = {
  _id: "test4",
  name: "èµµå…­", 
  contacts: [
    { name: "èµµå…­" }  // æ²¡æœ‰phoneå­—æ®µ
  ]
}
// é¢„æœŸç»“æœï¼šæ˜¾ç¤º "æœªè®¾ç½®ç”µè¯"
```

## âœ… ä¿®å¤æ•ˆæœ

1. **ä¸å†æŠ¥é”™**ï¼šå³ä½¿å®¢æˆ·æ•°æ®ä¸å®Œæ•´ä¹Ÿä¸ä¼šå´©æºƒ
2. **æ­£ç¡®æ˜¾ç¤º**ï¼šä¼˜å…ˆæ˜¾ç¤ºä¸»è¦ç”µè¯ï¼Œå…¶æ¬¡æ˜¾ç¤ºè”ç³»äººç”µè¯
3. **å‹å¥½æç¤º**ï¼šæ²¡æœ‰ç”µè¯æ—¶æ˜¾ç¤º"æœªè®¾ç½®ç”µè¯"
4. **æœç´¢æ­£å¸¸**ï¼šå¯ä»¥æœç´¢æ‰€æœ‰ç”µè¯å­—æ®µ

## ğŸ”„ æ•°æ®å…¼å®¹æ€§

ä¿®å¤åçš„ä»£ç å…¼å®¹å¤šç§æ•°æ®æ ¼å¼ï¼š

- âœ… æ–°æ ¼å¼ï¼š`customer.phone` + `customer.contacts[]`
- âœ… æ—§æ ¼å¼ï¼šåªæœ‰ `customer.contacts[]`
- âœ… ç©ºæ•°æ®ï¼š`customer.contacts = []` æˆ– `undefined`
- âœ… éƒ¨åˆ†æ•°æ®ï¼šè”ç³»äººå­˜åœ¨ä½†phoneä¸ºç©º

## ğŸ“ æ³¨æ„äº‹é¡¹

1. è¿™ä¸ªä¿®å¤æ˜¯å‘ä¸‹å…¼å®¹çš„ï¼Œä¸ä¼šå½±å“ç°æœ‰æ­£å¸¸æ•°æ®
2. å»ºè®®åç»­ç»Ÿä¸€å®¢æˆ·æ•°æ®ç»“æ„ï¼Œç¡®ä¿éƒ½æœ‰ä¸»è¦ç”µè¯å­—æ®µ
3. Webç«¯å·²ç»æ­£ç¡®å¤„ç†äº†è¿™ä¸ªé—®é¢˜ï¼Œæ— éœ€ä¿®æ”¹ 