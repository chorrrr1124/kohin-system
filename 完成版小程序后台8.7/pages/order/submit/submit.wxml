<!--pages/order/submit/submit.wxml-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <view class="page-title">ç¡®è®¤è®¢å•</view>
    <view class="page-subtitle">è¯·ç¡®è®¤è®¢å•ä¿¡æ¯å¹¶æäº¤</view>
  </view>

  <!-- æ”¶è´§åœ°å€ -->
  <view class="address-section" bindtap="selectAddress">
    <view class="section-header">
      <view class="section-title">æ”¶è´§åœ°å€</view>
      <view class="section-action">é€‰æ‹©åœ°å€ ></view>
    </view>
    
    <view wx:if="{{selectedAddress}}" class="address-info">
      <view class="address-name">{{selectedAddress.name}} {{selectedAddress.phone}}</view>
      <view class="address-detail">{{selectedAddress.province}}{{selectedAddress.city}}{{selectedAddress.district}}{{selectedAddress.detail}}</view>
    </view>
    
    <view wx:else class="address-placeholder">
      <view class="placeholder-icon">ğŸ“</view>
      <view class="placeholder-text">è¯·é€‰æ‹©æ”¶è´§åœ°å€</view>
    </view>
  </view>

  <!-- å•†å“åˆ—è¡¨ -->
  <view class="products-section">
    <view class="section-header">
      <view class="section-title">å•†å“ä¿¡æ¯</view>
      <view class="section-count">å…±{{cartItems.length}}ä»¶</view>
    </view>
    
    <view class="product-list">
      <view 
        class="product-item" 
        wx:for="{{cartItems}}" 
        wx:key="id"
      >
        <!-- å•†å“å›¾ç‰‡ -->
        <image 
          class="product-image" 
          src="{{item.imagePath || '/images/placeholder.png'}}"
          mode="aspectFill"
        ></image>
        
        <!-- å•†å“ä¿¡æ¯ -->
        <view class="product-info">
          <view class="product-name">{{item.name}}</view>
          <view class="product-meta" wx:if="{{item.brand}}">
            <text class="meta-label">å“ç‰Œï¼š</text>
            <text class="meta-value">{{item.brand}}</text>
          </view>
          <view class="product-meta" wx:if="{{item.specification}}">
            <text class="meta-label">è§„æ ¼ï¼š</text>
            <text class="meta-value">{{item.specification}}</text>
          </view>
          <view class="product-price">
            <text class="price-symbol">Â¥</text>
            <text class="price-value">{{item.price}}</text>
          </view>
        </view>
        
        <!-- æ•°é‡ä¿¡æ¯ -->
        <view class="product-quantity">
          <text class="quantity-label">æ•°é‡ï¼š</text>
          <text class="quantity-value">{{item.quantity}}</text>
        </view>
        
        <!-- å°è®¡ -->
        <view class="product-subtotal">
          <text class="subtotal-label">å°è®¡ï¼š</text>
          <text class="subtotal-value">Â¥{{item.price * item.quantity}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- è®¢å•ä¿¡æ¯ -->
  <view class="order-info-section">
    <view class="section-header">
      <view class="section-title">è®¢å•ä¿¡æ¯</view>
    </view>
    
    <view class="info-item">
      <text class="info-label">å•†å“æ€»ä»·ï¼š</text>
      <text class="info-value">Â¥{{totalAmount}}</text>
    </view>
    
    <view class="info-item">
      <text class="info-label">è¿è´¹ï¼š</text>
      <text class="info-value">Â¥0.00</text>
    </view>
    
    <view class="info-item total">
      <text class="info-label">å®ä»˜é‡‘é¢ï¼š</text>
      <text class="info-value total-amount">Â¥{{totalAmount}}</text>
    </view>
  </view>

  <!-- å¤‡æ³¨ä¿¡æ¯ -->
  <view class="remark-section">
    <view class="section-header">
      <view class="section-title">è®¢å•å¤‡æ³¨</view>
    </view>
    <textarea 
      class="remark-input" 
      placeholder="è¯·è¾“å…¥è®¢å•å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰" 
      bindinput="onRemarkInput"
      value="{{remark}}"
      maxlength="200"
    ></textarea>
    <view class="remark-count">{{remark.length}}/200</view>
  </view>

  <!-- åº•éƒ¨æäº¤åŒºåŸŸ -->
  <view class="bottom-submit">
    <view class="submit-info">
      <text class="submit-label">å®ä»˜é‡‘é¢ï¼š</text>
      <text class="submit-amount">Â¥{{totalAmount}}</text>
    </view>
    <button 
      class="submit-btn {{canSubmit ? '' : 'disabled'}}" 
      bindtap="submitOrder"
      disabled="{{!canSubmit}}"
    >
      æäº¤è®¢å•
    </button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{submitting}}" class="loading-overlay">
    <view class="loading-content">
      <view class="loading-spinner"></view>
      <view class="loading-text">æ­£åœ¨æäº¤è®¢å•...</view>
    </view>
  </view>
</view>